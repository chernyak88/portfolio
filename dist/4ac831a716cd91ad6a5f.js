(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{397:function(t,e,r){},414:function(t,e,r){"use strict";var i=r(397);r.n(i).a},431:function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"edit-form"},[r("div",{staticClass:"card"},[t._m(0),r("div",{staticClass:"card__content"},[r("div",{staticClass:"edit-form__container"},[r("div",{staticClass:"edit-form__col"},[r("label",{staticClass:"edit-form__btn-file"},[r("div",{staticClass:"edit-form__img",class:{filled:this.renderedPhotoUrl.length,error:t.validation.firstError("renderedPhotoUrl")},style:{backgroundImage:"url("+this.renderedPhotoUrl+")"}},[r("div",{staticClass:"edit-form__img-text"},[t._v("Перетащите или загрузите для загрузки изображения")]),r("label",{staticClass:"edit-form__btn-file"},[r("input",{staticClass:"btn-file-input",attrs:{type:"file"},on:{change:t.appendFileAndRenderPhoto}}),r("div",{staticClass:"btn-file-fake"},[t._v("ЗАГРУЗИТЬ")]),r("div",{staticClass:"btn-file-input-error"},[r("error-tooltip",{attrs:{errorText:t.validation.firstError("renderedPhotoUrl")}})],1)])])])]),r("div",{staticClass:"edit-form__col"},[r("div",{staticClass:"edit-form__row"},[r("label",{staticClass:"input",class:{error:t.validation.firstError("work.title")},attrs:{for:"title"}},[r("div",{staticClass:"input__title"},[t._v("Название")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.work.title,expression:"work.title"}],staticClass:"input__elem",attrs:{type:"text",name:"title",placeholder:"Введите название работы",id:"title"},domProps:{value:t.work.title},on:{input:function(e){e.target.composing||t.$set(t.work,"title",e.target.value)}}}),r("div",{staticClass:"edit-form-input-error"},[r("error-tooltip",{attrs:{errorText:t.validation.firstError("work.title")}})],1)])]),r("div",{staticClass:"edit-form__row"},[r("label",{staticClass:"input",class:{error:t.validation.firstError("work.link")},attrs:{for:"link"}},[r("div",{staticClass:"input__title"},[t._v("Ссылка")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.work.link,expression:"work.link"}],staticClass:"input__elem",attrs:{type:"text",name:"link",placeholder:"Вставьте ссылку",id:"link"},domProps:{value:t.work.link},on:{input:function(e){e.target.composing||t.$set(t.work,"link",e.target.value)}}}),r("div",{staticClass:"edit-form-input-error"},[r("error-tooltip",{attrs:{errorText:t.validation.firstError("work.link")}})],1)])]),r("div",{staticClass:"edit-form__row"},[r("label",{staticClass:"input",class:{error:t.validation.firstError("work.description")},attrs:{for:"description"}},[r("div",{staticClass:"input__title"},[t._v("Описание")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.work.description,expression:"work.description"}],staticClass:"textarea__elem",attrs:{name:"description",placeholder:"Введите описание работы",id:"description"},domProps:{value:t.work.description},on:{input:function(e){e.target.composing||t.$set(t.work,"description",e.target.value)}}}),r("div",{staticClass:"edit-form-input-error"},[r("error-tooltip",{attrs:{errorText:t.validation.firstError("work.description")}})],1)])]),r("div",{staticClass:"edit-form__row"},[r("div",{staticClass:"add-tags"},[r("div",{staticClass:"add-tags__wrapper"},[r("label",{staticClass:"input",class:{error:t.validation.firstError("editedTagsAsString")},attrs:{for:"tags"}},[r("div",{staticClass:"input__title"},[t._v("Добавление тэга")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.work.techs,expression:"work.techs"}],staticClass:"input__elem",attrs:{id:"tags",type:"text",name:"tags",placeholder:"Добавьте теги"},domProps:{value:t.work.techs},on:{change:function(e){return t.ADD_TAGS(t.work.techs)},input:function(e){e.target.composing||t.$set(t.work,"techs",e.target.value)}}}),r("div",{staticClass:"edit-form-input-error"},[r("error-tooltip",{attrs:{errorText:t.validation.firstError("editedTagsAsString")}})],1)])]),t.workForm.editMode?r("add-tags"):t._e()],1)])])]),r("div",{staticClass:"edit-form__buttons"},[r("div",{staticClass:"edit-form__buttons-item"},[r("button",{staticClass:"btn__clear",attrs:{type:"button"},on:{click:t.CLOSE_FORM}},[t._v("Отмена")])]),r("div",{staticClass:"edit-form__buttons-item"},[t.workForm.editMode?t._e():r("button",{staticClass:"btn__load",attrs:{type:"button"},on:{click:t.addNewWork}},[t._v("Загрузить")]),t.workForm.editMode?r("button",{staticClass:"btn__load",attrs:{type:"button"},on:{click:t.saveEditedWork}},[t._v("Сохранить")]):t._e()])])])])])};i._withStripped=!0;var o=r(94),a=r(342);function s(t,e,r,i,o,a,s){try{var n=t[a](s),d=n.value}catch(t){return void r(t)}n.done?e(d):Promise.resolve(d).then(i,o)}function n(t){return function(){var e=this,r=arguments;return new Promise(function(i,o){var a=t.apply(e,r);function n(t){s(a,i,o,n,d,"next",t)}function d(t){s(a,i,o,n,d,"throw",t)}n(void 0)})}}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),i.forEach(function(e){l(t,e,r[e])})}return t}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c={mixins:[r(342).mixin],validators:{renderedPhotoUrl:function(t){return a.Validator.value(t).required("Загрузите картинку")},"work.title":function(t){return a.Validator.value(t).required("Введите название")},"work.link":function(t){return a.Validator.value(t).required("Вставьте ссылку")},"work.description":function(t){return a.Validator.value(t).required("Введите описание")},editedTagsAsString:function(t){return a.Validator.value(t).required("Работа должна содержать по крайней мере один тег")}},components:{addTags:function(){return r.e(14).then(r.bind(null,437))},errorTooltip:function(){return r.e(0).then(r.bind(null,435))}},data:function(){return{renderedPhotoUrl:"",work:{title:"",techs:"",photo:"",link:"",description:""}}},computed:d({},Object(o.e)("works",{workForm:function(t){return t.workForm},editedWork:function(t){return t.editedWork},editedTags:function(t){return t.editedTags}}),{remotePhotoPath:function(){return"https://webdev-api.loftschool.com/".concat(this.work.photo)},editedTagsAsString:function(){return this.editedTags.join(",")}}),methods:d({},Object(o.b)("works",["addWork","editWork"]),Object(o.d)("works",["CLOSE_FORM","ADD_TAGS"]),Object(o.d)("tooltip",["SHOW_TOOLTIP"]),{appendFileAndRenderPhoto:function(t){var e=this,r=t.target.files[0];this.work.photo=r;var i=new FileReader;try{i.readAsDataURL(r),i.onload=function(){e.renderedPhotoUrl=i.result}}catch(t){alert(t.message)}},addNewWork:function(){var t=n(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$validate();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=5;break}return t.abrupt("return");case 5:return t.prev=5,e=this.createWorkFormData(),t.next=9,this.addWork(e);case 9:this.SHOW_TOOLTIP({type:"good",text:"Работа добавлена"}),this.CLOSE_FORM(),t.next=17;break;case 13:t.prev=13,t.t1=t.catch(5),alert(t.t1.message),this.SHOW_TOOLTIP({type:"error",text:"Произошла ошибка"});case 17:case"end":return t.stop()}},t,this,[[5,13]])}));return function(){return t.apply(this,arguments)}}(),createWorkFormData:function(){var t=new FormData;return t.append("title",this.work.title),this.workForm.editMode?t.append("techs",this.editedTagsAsString):t.append("techs",this.work.techs),t.append("photo",this.work.photo),t.append("link",this.work.link),t.append("description",this.work.description),t},setEditedWork:function(){this.work=d({},this.editedWork),this.renderedPhotoUrl=this.remotePhotoPath},saveEditedWork:function(){var t=n(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$validate();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=5;break}return t.abrupt("return");case 5:return t.prev=5,e={id:this.work.id,data:this.createWorkFormData()},t.next=9,this.editWork(e);case 9:this.SHOW_TOOLTIP({type:"good",text:"Работа обновлена"}),this.CLOSE_FORM(),t.next=17;break;case 13:t.prev=13,t.t1=t.catch(5),alert(t.t1.message),this.SHOW_TOOLTIP({type:"error",text:"Произошла ошибка"});case 17:case"end":return t.stop()}},t,this,[[5,13]])}));return function(){return t.apply(this,arguments)}}()}),created:function(){this.workForm.editMode&&(this.setEditedWork(),this.work.techs="")}},u=(r(414),r(341)),p=Object(u.a)(c,i,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card__title"},[e("div",{staticClass:"card__title-text"},[this._v("Редактирование работы")])])}],!1,null,"81c14d5a",null);p.options.__file="src/admin/components/work/workForm.vue";e.default=p.exports}}]);